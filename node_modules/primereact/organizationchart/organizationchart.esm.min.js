import*as e from"react";import{classNames as n,ObjectUtils as t,DomHandler as r}from"primereact/utils";function l(){return l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},l.apply(this,arguments)}function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function a(e){if(Array.isArray(e))return i(e)}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){if(Array.isArray(e))return e}function p(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,l,o=[],i=!0,a=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){a=!0,l=e}finally{try{i||null==t.return||t.return()}finally{if(a)throw l}}return o}}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var m=e.memo((function(r){var l,o,i,a,c,s,h=r.node,g=e.useState(h.expanded),y=(o=2,d(l=g)||p(l,o)||u(l,o)||f()),v=y[0],b=y[1],E=!1!==h.leaf&&!(h.children&&h.children.length),N=h.children&&h.children.length?2*h.children.length:null,S=r.isSelected(h),O=!E&&v?"inherit":"hidden",j=function(e,n){r.onNodeClick(e,n)},w=function(){if(!E){var t=n("p-node-toggler-icon",{"pi pi-chevron-down":v,"pi pi-chevron-up":!v});return e.createElement("a",{href:"#",className:"p-node-toggler",onClick:function(e){return n=e,b((function(e){return!e})),void n.preventDefault();var n}},e.createElement("i",{className:t}))}return null},z=function(){var n=r.nodeTemplate&&t.getJSXElement(r.nodeTemplate,h)||h.label;return e.createElement("div",null,n)},C=(i=n("p-organizationchart-node-content",{"p-organizationchart-selectable-node":r.selectionMode&&!1!==h.selectable,"p-highlight":S},h.className),a=z(),c=w(),e.createElement("tr",null,e.createElement("td",{colSpan:N},e.createElement("div",{className:i,onClick:function(e){return j(e,h)}},a,c)))),M=e.createElement("tr",{style:{visibility:O},className:"p-organizationchart-lines"},e.createElement("td",{colSpan:N},e.createElement("div",{className:"p-organizationchart-line-down"}))),P=(s=h.children&&h.children.length,e.createElement("tr",{style:{visibility:O},className:"p-organizationchart-lines"},h.children&&1===h.children.length&&e.createElement("td",{colSpan:N},e.createElement("div",{className:"p-organizationchart-line-down"})),h.children&&h.children.length>1&&h.children.map((function(t,r){var l=n("p-organizationchart-line-left",{"p-organizationchart-line-top":0!==r}),o=n("p-organizationchart-line-right",{"p-organizationchart-line-top":r!==s-1});return[e.createElement("td",{key:r+"_lineleft",className:l}," "),e.createElement("td",{key:r+"_lineright",className:o}," ")]})))),k=e.createElement("tr",{style:{visibility:O},className:"p-organizationchart-nodes"},h.children&&h.children.map((function(n,t){return e.createElement("td",{key:t,colSpan:"2"},e.createElement(m,{node:n,nodeTemplate:r.nodeTemplate,selectionMode:r.selectionMode,onNodeClick:r.onNodeClick,isSelected:r.isSelected}))})));return e.createElement("table",{className:"p-organizationchart-table"},e.createElement("tbody",null,C,M,P,k))}));function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}m.displayName="OrganizationChartNode";var y=e.memo(e.forwardRef((function(o,i){var d=e.useRef(null),p=o.value&&o.value.length?o.value[0]:null,f=function(e){if(o.selectionMode&&o.selection){if("single"===o.selectionMode)return o.selection===e?0:-1;if("multiple"===o.selectionMode)return o.selection.findIndex((function(n){return n===e}))}return-1};e.useImperativeHandle(i,(function(){return g({getElement:function(){return d.current}},o)}));var h=t.findDiffKeys(o,y.defaultProps),v=n("p-organizationchart p-component",o.className);return e.createElement("div",l({id:o.id,ref:d,style:o.style,className:v},h),e.createElement(m,{node:p,nodeTemplate:o.nodeTemplate,selectionMode:o.selectionMode,onNodeClick:function(e,n){if(o.selectionMode){var t=e.target;if(!1===n.selectable||!r.hasClass(t,"p-node-toggler")||!r.hasClass(t,"p-node-toggler-icon"))return;var l,i=f(n),d=i>=0;"single"===o.selectionMode?d?(l=null,o.onNodeUnselect&&o.onNodeUnselect({originalEvent:e,node:n})):(l=n,o.onNodeSelect&&o.onNodeSelect({originalEvent:e,node:n})):"multiple"===o.selectionMode&&(d?(l=o.selection.filter((function(e,n){return n!==i})),o.onNodeUnselect&&o.onNodeUnselect({originalEvent:e,node:n})):(l=[].concat(a(p=o.selection||[])||c(p)||u(p)||s(),[n]),o.onNodeSelect&&o.onNodeSelect({originalEvent:e,node:n}))),o.onSelectionChange&&o.onSelectionChange({originalEvent:e,data:l})}var p},isSelected:function(e){return-1!==f(e)}}))})));y.displayName="OrganizationChart",y.defaultProps={__TYPE:"OrganizationChart",id:null,value:null,style:null,className:null,selectionMode:null,selection:null,nodeTemplate:null,onSelectionChange:null,onNodeSelect:null,onNodeUnselect:null};export{y as OrganizationChart};
