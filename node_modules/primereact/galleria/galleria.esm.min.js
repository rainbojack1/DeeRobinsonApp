import*as e from"react";import t from"primereact/api";import{CSSTransition as n}from"primereact/csstransition";import{useMountEffect as a,usePrevious as r,useResizeListener as i,useUpdateEffect as l,useInterval as o,useUnmountEffect as c}from"primereact/hooks";import{Portal as u}from"primereact/portal";import{Ripple as s}from"primereact/ripple";import{classNames as m,UniqueComponentId as p,DomHandler as v,ObjectUtils as d,ZIndexUtils as f}from"primereact/utils";function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},h.apply(this,arguments)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){if(Array.isArray(e))return e}function b(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);l=!0);}catch(e){o=!0,r=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw r}}return i}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function x(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){return I(e)||b(e,t)||x(e,t)||w()}var N=e.memo(e.forwardRef((function(t,n){var r=function(){t.slideShowActive&&t.stopSlideShow&&t.stopSlideShow()},i=function(e){r(),t.onActiveItemChange({index:t.circular&&0===t.activeItemIndex?t.value.length-1:0!==t.activeItemIndex?t.activeItemIndex-1:0}),e&&e.cancelable&&e.preventDefault()},l=function(e){r(),t.onActiveItemChange({index:t.circular&&t.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1}),e&&e.cancelable&&e.preventDefault()},o=function(e){r(),t.onActiveItemChange({index:e})},c=function(e){t.changeItemOnIndicatorHover&&(r(),t.onActiveItemChange({index:e}))},u=function(e,n){13===e.which&&(r(),t.onActiveItemChange({index:n}))};a((function(){t.autoPlay&&t.startSlideShow()}));var p=function(n){var a="p-galleria-indicator-"+n,r=m("p-galleria-indicator",{"p-highlight":t.activeItemIndex===n}),i=t.indicator&&t.indicator(n);return i||(i=e.createElement("button",{type:"button",tabIndex:-1,className:"p-link"},e.createElement(s,null))),e.createElement("li",{className:r,key:a,tabIndex:0,onClick:function(){return o(n)},onMouseEnter:function(){return c(n)},onKeyDown:function(e){return u(e,n)}},i)},v=t.itemTemplate&&t.itemTemplate(t.value[t.activeItemIndex]),d=function(){if(t.showItemNavigators){var n=!t.circular&&0===t.activeItemIndex,a=m("p-galleria-item-prev p-galleria-item-nav p-link",{"p-disabled":n});return e.createElement("button",{type:"button",className:a,onClick:i,disabled:n},e.createElement("span",{className:"p-galleria-item-prev-icon pi pi-chevron-left"}),e.createElement(s,null))}return null}(),f=function(){if(t.showItemNavigators){var n=!t.circular&&t.activeItemIndex===t.value.length-1,a=m("p-galleria-item-next p-galleria-item-nav p-link",{"p-disabled":n});return e.createElement("button",{type:"button",className:a,onClick:l,disabled:n},e.createElement("span",{className:"p-galleria-item-next-icon pi pi-chevron-right"}),e.createElement(s,null))}return null}(),h=function(){if(t.caption){var n=t.caption(t.value[t.activeItemIndex]);return e.createElement("div",{className:"p-galleria-caption"},n)}return null}(),g=function(){if(t.showIndicators){for(var n=m("p-galleria-indicators p-reset",t.indicatorsContentClassName),a=[],r=0;r<t.value.length;r++)a.push(p(r));return e.createElement("ul",{className:n},a)}return null}();return e.createElement("div",{ref:n,className:"p-galleria-item-wrapper"},e.createElement("div",{className:"p-galleria-item-container"},d,e.createElement("div",{className:"p-galleria-item"},v),f,h),g)})));function S(e){if(Array.isArray(e))return y(e)}function O(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}N.displayName="GalleriaItem";var P=e.memo((function(t){var n=t.active?0:null,a=t.template&&t.template(t.item),r=m("p-galleria-thumbnail-item",{"p-galleria-thumbnail-item-current":t.current,"p-galleria-thumbnail-item-active":t.active,"p-galleria-thumbnail-item-start":t.start,"p-galleria-thumbnail-item-end":t.end},t.className);return e.createElement("div",{className:r},e.createElement("div",{className:"p-galleria-thumbnail-item-content",tabIndex:n,onClick:function(e){t.onItemClick({originalEvent:e,index:t.index})},onKeyDown:function(e){13===e.which&&t.onItemClick({originalEvent:e,index:t.index})}},a))})),T=e.memo(e.forwardRef((function(n,o){var c=E(e.useState(n.numVisible),2),u=c[0],f=c[1],h=E(e.useState(0),2),g=h[0],I=h[1],b=e.useRef(null),y=e.useRef(null),w=e.useRef(""),N=e.useRef(null),T=e.useRef(null),A=r(u),k=r(n.activeItemIndex),V=E(i({listener:function(){U()},when:n.responsiveOptions}),1)[0],j=function(e){var t=g+e;e<0&&-1*t+u>n.value.length-1?t=u-n.value.length:e>0&&t>0&&(t=0),n.circular&&(e<0&&n.value.length-1===n.activeItemIndex?t=0:e>0&&0===n.activeItemIndex&&(t=u-n.value.length)),b.current&&(v.removeClass(b.current,"p-items-hidden"),b.current.style.transform=n.isVertical?"translate3d(0, ".concat(t*(100/u),"%, 0)"):"translate3d(".concat(t*(100/u),"%, 0, 0)"),b.current.style.transition="transform 500ms ease 0s"),I(t)},H=function(){n.slideShowActive&&n.stopSlideShow&&n.stopSlideShow()},D=function(){var e=Math.floor(u/2);return u%2?e:e-1},R=function(e){H();var t=0!==n.activeItemIndex?n.activeItemIndex-1:0;u-(t+g)-1>D()&&(-1*g!=0||n.circular)&&j(1),n.onActiveItemChange({index:n.circular&&0===n.activeItemIndex?n.value.length-1:t}),e.cancelable&&e.preventDefault()},M=function(e){H();var t=n.activeItemIndex+1;t+g>D()&&(-1*g<z()-1||n.circular)&&j(-1),n.onActiveItemChange({index:n.circular&&n.value.length-1===n.activeItemIndex?0:t}),e.cancelable&&e.preventDefault()},G=function(e){H();var t=e.index;if(t!==n.activeItemIndex){var a=t+g,r=0;t<n.activeItemIndex?(r=u-a-1-D())>0&&-1*g!=0&&j(r):(r=D()-a)<0&&-1*g<z()-1&&j(r),n.onActiveItemChange({index:t})}},K=function(e){b.current&&"transform"===e.propertyName&&(v.addClass(b.current,"p-items-hidden"),b.current.style.transition="")},Y=function(e){var t=e.changedTouches[0];y.current={x:t.pageX,y:t.pageY}},Z=function(e){e.cancelable&&e.preventDefault()},X=function(e){var t=e.changedTouches[0];_(e,n.isVertical?t.pageY-y.current.y:t.pageX-y.current.x)},_=function(e,t){t<0?M(e):R(e)},z=function(){return n.value.length>u?n.value.length-u+1:0},L=function(){N.current||(N.current=v.createInlineStyle(t.nonce));var e,a="\n            .p-galleria-thumbnail-items[".concat(w.current,"] .p-galleria-thumbnail-item {\n                flex: 1 0 ").concat(100/u,"%\n            }\n        ");if(n.responsiveOptions){T.current=S(e=n.responsiveOptions)||O(e)||x(e)||C(),T.current.sort((function(e,n){return d.sort(e.breakpoint,n.breakpoint,-1,t.locale)}));for(var r=0;r<T.current.length;r++){var i=T.current[r];a+="\n                    @media screen and (max-width: ".concat(i.breakpoint,") {\n                        .p-galleria-thumbnail-items[").concat(w.current,"] .p-galleria-thumbnail-item {\n                            flex: 1 0 ").concat(100/i.numVisible,"%\n                        }\n                    }\n                ")}}N.current.innerHTML=a},U=function(){if(b.current&&T.current){for(var e=window.innerWidth,t={numVisible:n.numVisible},a=0;a<T.current.length;a++){var r=T.current[a];parseInt(r.breakpoint,10)>=e&&(t=r)}u!==t.numVisible&&f(t.numVisible)}};a((function(){b.current&&(w.current=p(),b.current.setAttribute(w.current,"")),L(),U(),V()})),l((function(){var e=g;A===u&&k===n.activeItemIndex||((e=n.activeItemIndex<=D()?0:n.value.length-u+D()<n.activeItemIndex?u-n.value.length:n.value.length-u<n.activeItemIndex&&u%2==0?-1*n.activeItemIndex+D()+1:-1*n.activeItemIndex+D())!==g&&I(e),b.current.style.transform=n.isVertical?"translate3d(0, ".concat(e*(100/u),"%, 0)"):"translate3d(".concat(e*(100/u),"%, 0, 0)"),k!==n.activeItemIndex&&(v.removeClass(b.current,"p-items-hidden"),b.current.style.transition="transform 500ms ease 0s"))}));var W,$,q,B,F=function(){if(n.showThumbnailNavigators){var t=!n.circular&&0===n.activeItemIndex||n.value.length<=u,a=m("p-galleria-thumbnail-prev p-link",{"p-disabled":t}),r=m("p-galleria-thumbnail-prev-icon pi",{"pi-chevron-left":!n.isVertical,"pi-chevron-up":n.isVertical});return e.createElement("button",{className:a,onClick:R,disabled:t},e.createElement("span",{className:r}),e.createElement(s,null))}return null},J=function(){if(n.showThumbnailNavigators){var t=!n.circular&&n.activeItemIndex===n.value.length-1||n.value.length<=u,a=m("p-galleria-thumbnail-next p-link",{"p-disabled":t}),r=m("p-galleria-thumbnail-next-icon pi",{"pi-chevron-right":!n.isVertical,"pi-chevron-down":n.isVertical});return e.createElement("button",{className:a,onClick:M,disabled:t},e.createElement("span",{className:r}),e.createElement(s,null))}return null},Q=(W=n.value.map((function(t,a){var r=-1*g,i=r+u-1;return e.createElement(P,{key:a,index:a,template:n.itemTemplate,item:t,active:r<=a&&i>=a,start:r===a,end:i===a,onItemClick:G,current:n.activeItemIndex===a})})),$=n.isVertical?n.contentHeight:"",q=F(),B=J(),e.createElement("div",{className:"p-galleria-thumbnail-container"},q,e.createElement("div",{className:"p-galleria-thumbnail-items-container",style:{height:$}},e.createElement("div",{ref:b,className:"p-galleria-thumbnail-items",onTransitionEnd:K,onTouchStart:Y,onTouchMove:Z,onTouchEnd:X},W)),B));return e.createElement("div",{className:"p-galleria-thumbnail-wrapper"},Q)})));function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}P.displayName="GalleriaThumbnailItem",T.displayName="GalleriaThumbnails";var V=e.memo(e.forwardRef((function(a,r){var i=E(e.useState(!1),2),l=i[0],p=i[1],g=E(e.useState(a.numVisible),2),I=g[0],b=g[1],y=E(e.useState(!1),2),x=y[0],w=y[1],S=E(e.useState(a.activeIndex),2),O=S[0],C=S[1],P=e.useRef(null),A=e.useRef(null),j=e.useRef(null),H=a.onItemChange?a.activeIndex:O,D="left"===a.thumbnailsPosition||"right"===a.thumbnailsPosition;o((function(){R({index:a.circular&&a.value.length-1===H?0:H+1})}),a.transitionInterval,x);var R=function(e){a.onItemChange?a.onItemChange(e):C(e.index)},M=function(){p(!0)},G=function(){p(!1)},K=function(){v.addClass(document.body,"p-overflow-hidden")},Y=function(){f.set("modal",j.current,t.autoZIndex,a.baseZIndex||t.zIndex.modal),v.addMultipleClasses(j.current,"p-component-overlay p-component-overlay-enter")},Z=function(){a.onShow&&a.onShow()},X=function(){v.removeClass(document.body,"p-overflow-hidden"),v.addClass(j.current,"p-component-overlay-leave")},_=function(){f.clear(j.current),a.onHide&&a.onHide()},z=function(){return x},L=function(){w(!0)},U=function(){w(!1)},W=function(e,t){var n=["top","left","bottom","right"].find((function(e){return e===t}));return n?"".concat(e,"-").concat(n):""};e.useEffect((function(){a.value&&a.value.length<I&&b(a.value.length)}),[a.value,I]),e.useEffect((function(){b(a.numVisible)}),[a.numVisible]),c((function(){x&&U(),f.clear(j.current)})),e.useImperativeHandle(r,(function(){return k({show:M,hide:G,isAutoPlayActive:z,startSlideShow:L,stopSlideShow:U,getElement:function(){return P.current},getPreviewContent:function(){return A.current}},a)}));return d.isNotEmpty(a.value)&&function(){var t,r,i,o,c,p,v,f=(t=d.findDiffKeys(a,V.defaultProps),r=a.showThumbnails&&W("p-galleria-thumbnails",a.thumbnailsPosition),i=a.showIndicators&&W("p-galleria-indicators",a.indicatorsPosition),o=m("p-galleria p-component",a.className,{"p-galleria-fullscreen":a.fullScreen,"p-galleria-indicator-onitem":a.showIndicatorsOnItem,"p-galleria-item-nav-onhover":a.showItemNavigatorsOnHover&&!a.fullScreen},r,i),c=a.fullScreen&&e.createElement("button",{type:"button",className:"p-galleria-close p-link",onClick:G},e.createElement("span",{className:"p-galleria-close-icon pi pi-times"}),e.createElement(s,null)),p=a.header?e.createElement("div",{className:"p-galleria-header"},a.header):null,v=a.footer?e.createElement("div",{className:"p-galleria-footer"},a.footer):null,e.createElement("div",h({ref:P,id:a.id,className:o,style:a.style},t),c,p,e.createElement("div",{className:"p-galleria-content"},e.createElement(N,{ref:A,value:a.value,activeItemIndex:H,onActiveItemChange:R,itemTemplate:a.item,circular:a.circular,caption:a.caption,showIndicators:a.showIndicators,changeItemOnIndicatorHover:a.changeItemOnIndicatorHover,indicator:a.indicator,showItemNavigators:a.showItemNavigators,autoPlay:a.autoPlay,slideShowActive:x,startSlideShow:L,stopSlideShow:U}),a.showThumbnails&&e.createElement(T,{value:a.value,activeItemIndex:H,onActiveItemChange:R,itemTemplate:a.thumbnail,numVisible:I,responsiveOptions:a.responsiveOptions,circular:a.circular,isVertical:D,contentHeight:a.verticalThumbnailViewPortHeight,showThumbnailNavigators:a.showThumbnailNavigators,autoPlay:a.autoPlay,slideShowActive:x,stopSlideShow:U})),v));if(a.fullScreen){var g=m("p-galleria-mask",{"p-galleria-visible":l});return e.createElement(u,{element:e.createElement("div",{ref:j,className:g},e.createElement(n,{nodeRef:P,classNames:"p-galleria",in:l,timeout:{enter:150,exit:150},options:a.transitionOptions,unmountOnExit:!0,onEnter:K,onEntering:Y,onEntered:Z,onExit:X,onExited:_},f))})}return f}()})));V.displayName="Galleria",V.defaultProps={__TYPE:"Galleria",id:null,value:null,activeIndex:0,fullScreen:!1,item:null,thumbnail:null,indicator:null,caption:null,className:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showItemNavigators:!1,showThumbnailNavigators:!0,showItemNavigatorsOnHover:!1,changeItemOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,showThumbnails:!0,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnItem:!1,indicatorsPosition:"bottom",baseZIndex:0,transitionOptions:null,onItemChange:null};export{V as Galleria};
