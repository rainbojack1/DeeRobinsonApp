import*as e from"react";import t from"primereact/api";import{useResizeListener as r,useOverlayScrollListener as n,useMountEffect as o,useUpdateEffect as u,useUnmountEffect as i}from"primereact/hooks";import{Portal as a}from"primereact/portal";import{DomHandler as c,ZIndexUtils as l,ObjectUtils as s,classNames as f}from"primereact/utils";function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e){if(Array.isArray(e))return h(e)}function v(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e){if(Array.isArray(e))return e}function w(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,u=[],i=!0,a=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(u.push(n.value),!t||u.length!==t);i=!0);}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}return u}}function E(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(e,t){return b(e)||w(e,t)||y(e,t)||E()}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=e.memo(e.forwardRef((function(h,b){var w=O(e.useState(!1),2),E=w[0],T=w[1],S=O(e.useState(h.position),2),k=S[0],D=S[1],P=O(e.useState(""),2),A=P[0],I=P[1],C=e.useRef(null),H=e.useRef(null),L=e.useRef(null),N=e.useRef(null),R=e.useRef(!0),W=e.useRef({}),B=e.useRef(null),Z=O(r({listener:function(e){!c.isTouchDevice()&&re(e)}}),2),F=Z[0],M=Z[1],Y=O(n({target:L.current,listener:function(e){re(e)},when:E}),2),_=Y[0],z=Y[1],K=function(e){return q(e,"mousetrack")||h.mouseTrack},U=function(e){return"true"===q(e,"disabled")||G(e,"disabled")||h.disabled},X=function(e){return q(e,"showondisabled")||h.showOnDisabled},$=function(){return q(L.current,"autohide")||h.autoHide},q=function(e,t){return G(e,"data-pr-".concat(t))?e.getAttribute("data-pr-".concat(t)):null},G=function(e,t){return e&&e.hasAttribute(t)},J=function(e){var t=q(e,"showevent")||h.showEvent,r=q(e,"hideevent")||h.hideEvent;K(e)?(t="mousemove",r="mouseleave"):"focus"===(q(e,"event")||h.event)&&(t="focus",r="blur");return{showEvent:t,hideEvent:r}},Q=function(e){return{top:q(e,"mousetracktop")||h.mouseTrackTop,left:q(e,"mousetrackleft")||h.mouseTrackLeft}},V=function(e,t){if(H.current){var r=q(e,"tooltip")||h.content;r?(H.current.innerHTML="",H.current.appendChild(document.createTextNode(r)),t()):h.children&&t()}},ee=function(e){V(L.current,(function(){var r=B.current,n=r.pageX,o=r.pageY;h.autoZIndex&&!l.get(C.current)&&l.set("tooltip",C.current,t.autoZIndex,h.baseZIndex||t.zIndex.tooltip),C.current.style.left="",C.current.style.top="",$()&&(C.current.style.pointerEvents="none"),K(L.current)&&!N.current&&(N.current={width:c.getOuterWidth(C.current),height:c.getOuterHeight(C.current)}),ne(L.current,{x:n,y:o},e)}))},te=function(e){L.current=e.currentTarget;var t,r=U(L.current);(t=X(L.current)&&r?L.current.firstChild:L.current,!(h.content||q(t,"tooltip")||h.children))||r||(B.current=e,E?le("updateDelay",ee):se(h.onBeforeShow,{originalEvent:e,target:L.current})&&le("showDelay",(function(){T(!0),se(h.onShow,{originalEvent:e,target:L.current})})))},re=function(e){(fe(),E)&&(se(h.onBeforeHide,{originalEvent:e,target:L.current})&&le("hideDelay",(function(){($()||!1!==R.current)&&(l.clear(C.current),c.removeClass(C.current,"p-tooltip-active"),T(!1),se(h.onHide,{originalEvent:e,target:L.current}))})))},ne=function(e,t,r){var n=0,o=0,u=r||k;if(K(e)&&t){var i={width:c.getOuterWidth(C.current),height:c.getOuterHeight(C.current)};n=t.x,o=t.y;var a=Q(e),l=a.top,s=a.left;switch(u){case"left":n-=i.width+s,o-=i.height/2-l;break;case"right":n+=s,o-=i.height/2-l;break;case"top":n-=i.width/2-s,o-=i.height+l;break;case"bottom":n-=i.width/2-s,o+=l}n<=0||N.current.width>i.width?(C.current.style.left="0px",C.current.style.right=window.innerWidth-i.width-n+"px"):(C.current.style.right="",C.current.style.left=n+"px"),C.current.style.top=o+"px",c.addClass(C.current,"p-tooltip-active")}else{var f=c.findCollisionPosition(u),p=q(e,"my")||h.my||f.my,d=q(e,"at")||h.at||f.at;C.current.style.padding="0px",c.flipfitCollision(C.current,e,p,d,(function(e){var t=e.at,r=t.x,n=h.at?"center"!==r&&r!==e.my.x?r:t.y:e.at["".concat(f.axis)];C.current.style.padding="",D(n),oe(n),c.addClass(C.current,"p-tooltip-active")}))}},oe=function(e){if(C.current){var t=getComputedStyle(C.current);"left"===e?C.current.style.left=parseFloat(t.left)-2*parseFloat(t.paddingLeft)+"px":"top"===e&&(C.current.style.top=parseFloat(t.top)-2*parseFloat(t.paddingTop)+"px")}},ue=function(){$()||(R.current=!1)},ie=function(e){$()||(R.current=!0,re(e))},ae=function(e){if(e){var t=J(e),r=t.showEvent,n=t.hideEvent,o=pe(e);o.addEventListener(r,te),o.addEventListener(n,re)}},ce=function(e){if(e){var t=J(e),r=t.showEvent,n=t.hideEvent,o=pe(e);o.removeEventListener(r,te),o.removeEventListener(n,re)}},le=function(e,t){fe();var r=q(L.current,e.toLowerCase())||h[e];r?W.current["".concat(e)]=setTimeout((function(){return t()}),r):t()},se=function(e){if(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=e.apply(void 0,r);return void 0===o&&(o=!0),o}return!0},fe=function(){Object.keys(W.current).forEach((function(e){return clearTimeout(e)}))},pe=function(e){if(e){if(X(e)){if(e.hasWrapper)return e.parentElement;var t=document.createElement("span");return e.parentNode.insertBefore(t,e),t.appendChild(e),e.hasWrapper=!0,t}var r;return e.hasWrapper&&((r=e.parentElement).replaceWith.apply(r,m(n=e.parentElement.childNodes)||v(n)||y(n)||g()),delete e.hasWrapper),e}var n;return null},de=function(e){me(e),he(e)},he=function(e){ve(e||h.target,ae)},me=function(e){ve(e||h.target,ce)},ve=function(e,t){if(e=s.getRefElement(e))if(c.isElement(e))t(e);else{var r=function(e){c.find(document,e).forEach((function(e){t(e)}))};e instanceof Array?e.forEach((function(e){r(e)})):r(e)}};e.useEffect((function(){E&&L.current&&U(L.current)&&re()})),o((function(){he()})),u((function(){return he(),function(){me()}}),[te,re,h.target]),u((function(){if(E){var e=q(L.current,"position")||k,t=q(L.current,"classname");D(e),I(t),ee(e),F(),_()}else D(h.position),I(""),L.current=null,N.current=null,R.current=!0;return function(){M(),z()}}),[E]),u((function(){E&&le("updateDelay",(function(){V(L.current,(function(){ne(L.current)}))}))}),[h.content]),i((function(){fe(),me(),l.clear(C.current)})),e.useImperativeHandle(b,(function(){return x({updateTargetEvents:de,loadTargetEvents:he,unloadTargetEvents:me,getElement:function(){return C.current},getTarget:function(){return L.current}},h)}));var ye,ge,be,we;if(E){var Ee=(ge=s.findDiffKeys(h,j.defaultProps),be=f("p-tooltip p-component",d({},"p-tooltip-".concat(k),!0),h.className,A),ye=L.current,we=!(h.content||q(ye,"tooltip")),e.createElement("div",p({id:h.id,ref:C,className:be,style:h.style,role:"tooltip","aria-hidden":E},ge,{onMouseEnter:ue,onMouseLeave:ie}),e.createElement("div",{className:"p-tooltip-arrow"}),e.createElement("div",{ref:H,className:"p-tooltip-text"},we&&h.children)));return e.createElement(a,{element:Ee,appendTo:h.appendTo,visible:!0})}return null})));j.displayName="Tooltip",j.defaultProps={__TYPE:"Tooltip",id:null,target:null,content:null,disabled:!1,className:null,style:null,appendTo:null,position:"right",my:null,at:null,event:null,showEvent:"mouseenter",hideEvent:"mouseleave",autoZIndex:!0,baseZIndex:0,mouseTrack:!1,mouseTrackTop:5,mouseTrackLeft:5,showDelay:0,updateDelay:0,hideDelay:0,autoHide:!0,showOnDisabled:!1,onBeforeShow:null,onBeforeHide:null,onShow:null,onHide:null};export{j as Tooltip};
