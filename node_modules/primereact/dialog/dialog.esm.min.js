import*as e from"react";import t from"primereact/api";import{CSSTransition as n}from"primereact/csstransition";import{useEventListener as r,useMountEffect as o,useUpdateEffect as a,useUnmountEffect as i}from"primereact/hooks";import{Portal as l}from"primereact/portal";import{Ripple as c}from"primereact/ripple";import{DomHandler as u,UniqueComponentId as s,ZIndexUtils as m,ObjectUtils as d,classNames as p}from"primereact/utils";function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){if(Array.isArray(e))return b(e)}function h(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function v(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e){if(Array.isArray(e))return e}function S(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}}function x(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return E(e)||S(e,t)||v(e,t)||x()}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=e.forwardRef((function(g,b){var E=k(e.useState(g.id),2),S=E[0],x=E[1],z=k(e.useState(!1),2),D=z[0],P=z[1],R=k(e.useState(!1),2),I=R[0],N=R[1],j=k(e.useState(g.maximized),2),M=j[0],X=j[1],H=e.useRef(null),A=e.useRef(null),Y=e.useRef(null),T=e.useRef(null),B=e.useRef(null),_=e.useRef(null),V=e.useRef(!1),J=e.useRef(!1),L=e.useRef(null),W=e.useRef(null),Z=e.useRef(null),F=e.useRef(""),K=g.onMaximize?g.maximized:M,$=k(r({type:"keydown",listener:function(e){return pe(e)}}),2),U=$[0],q=$[1],G=k(r({type:"mousemove",target:function(){return window.document},listener:function(e){return ve(e)}}),2),Q=G[0],ee=G[1],te=k(r({type:"mouseup",target:function(){return window.document},listener:function(e){return we(e)}}),2),ne=te[0],re=te[1],oe=k(r({type:"mousemove",target:function(){return window.document},listener:function(e){return ge(e)}}),2),ae=oe[0],ie=oe[1],le=k(r({type:"mouseup",target:function(){return window.document},listener:function(e){return be(e)}}),2),ce=le[0],ue=le[1],se=function(e){g.onHide(),e.preventDefault()},me=function(e){g.dismissableMask&&g.modal&&A.current===e.target&&se(e),g.onMaskClick&&g.onMaskClick(e)},de=function(e){g.onMaximize?g.onMaximize({originalEvent:e,maximized:!K}):X((function(e){return!e})),e.preventDefault()},pe=function(e){var t=e.currentTarget;if(t&&t.primeDialogParams){var n=t.primeDialogParams,r=n.length,o=n[r-1]?n[r-1].id:void 0;if(o===S&&g.closeOnEscape){var a=document.getElementById(o);if(27===e.which)se(e),e.stopImmediatePropagation(),n.splice(r-1,1);else if(9===e.which){e.preventDefault();var i=u.getFocusableElements(a);if(i&&i.length>0)if(document.activeElement){var l=i.indexOf(document.activeElement);e.shiftKey?-1===l||0===l?i[i.length-1].focus():i[l-1].focus():-1===l||l===i.length-1?i[0].focus():i[l+1].focus()}else i[0].focus()}}}},fe=function(e){u.hasClass(e.target,"p-dialog-header-icon")||u.hasClass(e.target.parentElement,"p-dialog-header-icon")||g.draggable&&(V.current=!0,L.current=e.pageX,W.current=e.pageY,H.current.style.margin="0",u.addClass(document.body,"p-unselectable-text"),g.onDragStart&&g.onDragStart(e))},ge=function(e){if(V.current){var t=u.getOuterWidth(H.current),n=u.getOuterHeight(H.current),r=e.pageX-L.current,o=e.pageY-W.current,a=H.current.getBoundingClientRect(),i=a.left+r,l=a.top+o,c=u.getViewport();H.current.style.position="fixed",g.keepInViewport?(i>=g.minX&&i+t<c.width&&(L.current=e.pageX,H.current.style.left=i+"px"),l>=g.minY&&l+n<c.height&&(W.current=e.pageY,H.current.style.top=l+"px")):(L.current=e.pageX,H.current.style.left=i+"px",W.current=e.pageY,H.current.style.top=l+"px"),g.onDrag&&g.onDrag(e)}},be=function(e){V.current&&(V.current=!1,u.removeClass(document.body,"p-unselectable-text"),g.onDragEnd&&g.onDragEnd(e))},ye=function(e){g.resizable&&(J.current=!0,L.current=e.pageX,W.current=e.pageY,u.addClass(document.body,"p-unselectable-text"),g.onResizeStart&&g.onResizeStart(e))},he=function(e,t,n){!n&&(n=u.getViewport());var r=parseInt(e);return/^(\d+|(\.\d+))(\.\d+)?%$/.test(e)?r*(n[t]/100):r},ve=function(e){if(J.current){var t=e.pageX-L.current,n=e.pageY-W.current,r=u.getOuterWidth(H.current),o=u.getOuterHeight(H.current),a=H.current.getBoundingClientRect(),i=u.getViewport(),l=!parseInt(H.current.style.top)||!parseInt(H.current.style.left),c=he(H.current.style.minWidth,"width",i),s=he(H.current.style.minHeight,"height",i),m=r+t,d=o+n;l&&(m+=t,d+=n),(!c||m>c)&&a.left+m<i.width&&(H.current.style.width=m+"px"),(!s||d>s)&&a.top+d<i.height&&(H.current.style.height=d+"px"),L.current=e.pageX,W.current=e.pageY,g.onResize&&g.onResize(e)}},we=function(e){J.current&&(J.current=!1,u.removeClass(document.body,"p-unselectable-text"),g.onResizeEnd&&g.onResizeEnd(e))},Ee=function(){H.current.style.position="",H.current.style.left="",H.current.style.top="",H.current.style.margin=""},Se=function(){H.current.setAttribute(F.current,"")},xe=function(){var e;g.onShow&&g.onShow(),g.focusOnShow&&!((e=document.activeElement)&&H.current&&H.current.contains(e))&&g.closable&&g.showHeader&&_.current.focus(),Ce()},ke=function(){g.modal&&u.addClass(A.current,"p-component-overlay-leave")},ze=function(){V.current=!1,m.clear(A.current),P(!1),Oe()},Ce=function(){De(),(g.blockScroll||g.maximizable&&K)&&u.addClass(document.body,"p-overflow-hidden")},Oe=function(){(Pe(),g.modal)?document.primeDialogParams&&document.primeDialogParams.some((function(e){return e.hasBlockScroll}))&&u.removeClass(document.body,"p-overflow-hidden"):(g.blockScroll||g.maximizable&&K)&&u.removeClass(document.body,"p-overflow-hidden")},De=function(){if(g.draggable&&(ae(),ce()),g.resizable&&(Q(),ne()),g.closable){U();var e={id:S,hasBlockScroll:g.blockScroll};document.primeDialogParams=document.primeDialogParams?[].concat(y(t=document.primeDialogParams)||h(t)||v(t)||w(),[e]):[e]}var t},Pe=function(){ie(),ue(),ee(),re(),q(),document.primeDialogParams=document.primeDialogParams&&document.primeDialogParams.filter((function(e){return e.id!==S}))},Re=function(){if(!Z.current){Z.current=u.createInlineStyle(t.nonce);var e="";for(var n in g.breakpoints)e+="\n                    @media screen and (max-width: ".concat(n,") {\n                        .p-dialog[").concat(F.current,"] {\n                            width: ").concat(g.breakpoints[n]," !important;\n                        }\n                    }\n                ");Z.current.innerHTML=e}};o((function(){S||x(s()),F.current=s(),g.visible&&P(!0),g.breakpoints&&Re()})),a((function(){g.visible&&!D&&P(!0),g.visible!==I&&D&&N(g.visible)})),a((function(){D&&(m.set("modal",A.current,t.autoZIndex,g.baseZIndex||t.zIndex.modal),N(!0))}),[D]),a((function(){g.blockScroll||u[K?"addClass":"removeClass"](document.body,"p-overflow-hidden")}),[g.maximized,M]),i((function(){Oe(),u.removeInlineStyle(Z.current),m.clear(A.current)})),e.useImperativeHandle(b,(function(){return C({resetPosition:Ee,getElement:function(){return H.current},getMask:function(){return A.current},getContent:function(){return Y.current},getHeader:function(){return T.current},getFooter:function(){return B.current},getCloseButton:function(){return _.current}},g)}));var Ie,Ne,je,Me,Xe,He,Ae,Ye,Te,Be=function(){if(g.showHeader){var t=g.closable?e.createElement("button",{ref:_,type:"button",className:"p-dialog-header-icon p-dialog-header-close p-link","aria-label":g.ariaCloseIconLabel,onClick:se},e.createElement("span",{className:"p-dialog-header-close-icon pi pi-times"}),e.createElement(c,null)):null,n=(l=p("p-dialog-header-maximize-icon pi",{"pi-window-maximize":!K,"pi-window-minimize":K}),g.maximizable?e.createElement("button",{type:"button",className:"p-dialog-header-icon p-dialog-header-maximize p-link",onClick:de},e.createElement("span",{className:l}),e.createElement(c,null)):null),r=d.getJSXElement(g.icons,g),o=d.getJSXElement(g.header,g),a=S+"_header",i=p("p-dialog-header",g.headerClassName);return e.createElement("div",{ref:T,style:g.headerStyle,className:i,onMouseDown:fe},e.createElement("div",{id:a,className:"p-dialog-title"},o),e.createElement("div",{className:"p-dialog-header-icons"},r,n,t))}var l;return null},_e=function(){var t=p("p-dialog-content",g.contentClassName);return e.createElement("div",{id:S+"_content",ref:Y,className:t,style:g.contentStyle},g.children)},Ve=function(){var t=d.getJSXElement(g.footer,g);return t&&e.createElement("div",{ref:B,className:"p-dialog-footer"},t)};return D&&(Ne=d.findDiffKeys(g,O.defaultProps),je=p("p-dialog p-component",g.className,{"p-dialog-rtl":g.rtl,"p-dialog-maximized":K}),Me=p("p-dialog-mask",(Ie=["center","left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find((function(e){return e===g.position||e.replace("-","")===g.position})))?"p-dialog-".concat(Ie):"",{"p-component-overlay p-component-overlay-enter":g.modal,"p-dialog-visible":D,"p-dialog-draggable":g.draggable,"p-dialog-resizable":g.resizable},g.maskClassName),Xe=Be(),He=_e(),Ae=Ve(),Ye=g.resizable?e.createElement("span",{className:"p-resizable-handle",style:{zIndex:90},onMouseDown:ye}):null,Te=e.createElement("div",{ref:A,style:g.maskStyle,className:Me,onClick:me},e.createElement(n,{nodeRef:H,classNames:"p-dialog",timeout:{enter:"center"===g.position?150:300,exit:"center"===g.position?150:300},in:I,options:g.transitionOptions,unmountOnExit:!0,onEnter:Se,onEntered:xe,onExiting:ke,onExited:ze},e.createElement("div",f({ref:H,id:S,className:je,style:g.style,onClick:g.onClick,role:"dialog"},Ne,{"aria-labelledby":S+"_header","aria-describedby":S+"_content","aria-modal":g.modal}),Xe,He,Ae,Ye))),e.createElement(l,{element:Te,appendTo:g.appendTo,visible:!0}))}));O.displayName="Dialog",O.defaultProps={__TYPE:"Dialog",id:null,header:null,footer:null,visible:!1,position:"center",draggable:!0,resizable:!0,modal:!0,onHide:null,onShow:null,headerStyle:null,headerClassName:null,contentStyle:null,contentClassName:null,closeOnEscape:!0,dismissableMask:!1,rtl:!1,closable:!0,style:null,className:null,maskStyle:null,maskClassName:null,showHeader:!0,appendTo:null,baseZIndex:0,maximizable:!1,blockScroll:!1,icons:null,ariaCloseIconLabel:"Close",focusOnShow:!0,minX:0,minY:0,keepInViewport:!0,maximized:!1,breakpoints:null,transitionOptions:null,onMaximize:null,onDragStart:null,onDrag:null,onDragEnd:null,onResizeStart:null,onResize:null,onResizeEnd:null,onClick:null,onMaskClick:null};export{O as Dialog};
