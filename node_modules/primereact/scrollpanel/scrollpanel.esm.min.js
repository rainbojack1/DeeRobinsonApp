import*as r from"react";import{useMountEffect as t,useUnmountEffect as n}from"primereact/hooks";import{ObjectUtils as c,classNames as l,DomHandler as o}from"primereact/utils";function u(){return u=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},u.apply(this,arguments)}function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var p=r.forwardRef((function(a,s){var d=r.useRef(null),f=r.useRef(null),m=r.useRef(null),g=r.useRef(null),h=r.useRef(!1),b=r.useRef(!1),v=r.useRef(null),y=r.useRef(null),w=r.useRef(null),O=r.useRef(null),E=r.useRef(null),P=r.useRef(!1),j=function(){var e=f.current.scrollWidth,r=-1*(d.current.clientHeight-m.current.clientHeight);w.current=f.current.clientWidth/e;var t=f.current.scrollHeight,n=-1*(d.current.clientWidth-g.current.clientWidth);O.current=f.current.clientHeight/t,E.current=window.requestAnimationFrame((function(){w.current>=1?o.addClass(m.current,"p-scrollpanel-hidden"):(o.removeClass(m.current,"p-scrollpanel-hidden"),m.current.style.cssText="width:"+Math.max(100*w.current,10)+"%; left:"+f.current.scrollLeft/e*100+"%;bottom:"+r+"px;"),O.current>=1?o.addClass(g.current,"p-scrollpanel-hidden"):(o.removeClass(g.current,"p-scrollpanel-hidden"),g.current.style.cssText="height:"+Math.max(100*O.current,10)+"%; top: calc("+f.current.scrollTop/t*100+"% - "+m.current.clientHeight+"px);right:"+n+"px;")}))},C=function(e){h?x(e):(b||x(e),R(e))},x=function(e){var r=e.pageX-v.current;v.current=e.pageX,E.current=window.requestAnimationFrame((function(){f.current.scrollLeft+=r/w.current}))},R=function(r){var t=r.pageY-y.current;y.current=e.pageY,E.current=window.requestAnimationFrame((function(){f.current.scrollTop+=t/O.current}))},L=function e(r){o.removeClass(g.current,"p-scrollpanel-grabbed"),o.removeClass(m.current,"p-scrollpanel-grabbed"),o.removeClass(document.body,"p-scrollpanel-grabbed"),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",e),h.current=!1,b.current=!1},D=function(){j()};t((function(){var e,r,t;j(),window.addEventListener("resize",j),e=getComputedStyle(d.current),r=getComputedStyle(m.current),t=o.getHeight(d.current)-parseInt(r.height,10),"none"!==e["max-height"]&&0===t&&(d.current.style.height=f.current.offsetHeight+parseInt(r.height,10)>parseInt(e["max-height"],10)?e["max-height"]:f.current.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px"),P.current=!0})),n((function(){P.current&&window.removeEventListener("resize",j),E.current&&window.cancelAnimationFrame(E.current)})),r.useImperativeHandle(s,(function(){return i({refresh:D,getElement:function(){return d.current},getContent:function(){return f.current},getXBar:function(){return m.current},getYBar:function(){return g.current}},a)}));var H=c.findDiffKeys(a,p.defaultProps),F=l("p-scrollpanel p-component",a.className);return r.createElement("div",u({ref:d,id:a.id,className:F,style:a.style},H),r.createElement("div",{className:"p-scrollpanel-wrapper"},r.createElement("div",{ref:f,className:"p-scrollpanel-content",onScroll:j,onMouseEnter:j},a.children)),r.createElement("div",{ref:m,className:"p-scrollpanel-bar p-scrollpanel-bar-x",onMouseDown:function(e){h.current=!0,v.current=e.pageX,o.addClass(m.current,"p-scrollpanel-grabbed"),o.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",C),document.addEventListener("mouseup",L),e.preventDefault()}}),r.createElement("div",{ref:g,className:"p-scrollpanel-bar p-scrollpanel-bar-y",onMouseDown:function(e){b.current=!0,y.current=e.pageY,o.addClass(g.current,"p-scrollpanel-grabbed"),o.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",C),document.addEventListener("mouseup",L),e.preventDefault()}}))}));p.displayName="ScrollPanel",p.defaultProps={__TYPE:"ScrollPanel",id:null,style:null,className:null};export{p as ScrollPanel};
