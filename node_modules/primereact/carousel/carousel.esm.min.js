import*as e from"react";import t,{ariaLabel as n}from"primereact/api";import{Button as r}from"primereact/button";import{usePrevious as a,useResizeListener as l,useMountEffect as o,useUpdateEffect as c,useUnmountEffect as u}from"primereact/hooks";import{classNames as i,UniqueComponentId as s,ObjectUtils as p,DomHandler as m}from"primereact/utils";function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){if(Array.isArray(e))return d(e)}function g(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function b(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e){if(Array.isArray(e))return e}function O(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return l}}function C(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){return N(e)||O(e,t)||y(e,t)||C()}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=e.memo((function(t){var n=t.template(t.item),r=i(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end});return e.createElement("div",{className:r},n)})),j=e.memo(e.forwardRef((function(v,d){var N=E(e.useState(v.numVisible),2),O=N[0],C=N[1],P=E(e.useState(v.numScroll),2),I=P[0],k=P[1],T=E(e.useState(v.page*v.numScroll*-1),2),x=T[0],R=T[1],A=E(e.useState(v.page),2),V=A[0],M=A[1],D=e.useRef(null),H=e.useRef(null),L=e.useRef(0),_=e.useRef(!!v.autoplayInterval),Y=e.useRef(""),z=e.useRef(20),X=e.useRef(null),F=e.useRef(null),K=e.useRef(null),U=e.useRef(!1),W=e.useRef(null),$=a(I),q=a(O),B=a(v.value),G=a(v.page),J="vertical"===v.orientation,Q=v.circular||!!v.autoplayInterval,Z=Q&&v.value&&v.value.length>=O,ee=v.onPageChange?v.page:V,te=v.value?Math.max(Math.ceil((v.value.length-O)/I)+1,0):0,ne=te&&v.autoplayInterval&&_.current,re=E(l({listener:function(){le()},when:v.responsiveOptions}),1)[0],ae=function(e,t){var n=x;null!=t?(n=I*t*-1,Z&&(n-=O),U.current=!1):(n+=I*e,U.current&&(n+=L.current-I*e,U.current=!1),t=Math.abs(Math.floor((Z?n+O:n)/I)));Z&&V===te-1&&-1===e?(n=-1*(v.value.length+O),t=0):Z&&0===V&&1===e?(n=0,t=te-1):t===te-1&&L.current>0&&(n+=-1*L.current-I*e,U.current=!0),H.current&&(m.removeClass(H.current,"p-items-hidden"),he(n),H.current.style.transition="transform 500ms ease 0s"),v.onPageChange?(R(n),v.onPageChange({page:t})):(M(t),R(n))},le=function(){if(H.current&&W.current){for(var e=window.innerWidth,t={numVisible:v.numVisible,numScroll:v.numScroll},n=0;n<W.current.length;n++){var r=W.current[n];parseInt(r.breakpoint,10)>=e&&(t=r)}if(I!==t.numScroll){var a=Math.floor(ee*I/t.numScroll),l=t.numScroll*a*-1;Z&&(l-=t.numVisible),R(l),k(t.numScroll),v.onPageChange?v.onPageChange({page:a}):M(a)}O!==t.numVisible&&C(t.numVisible)}},oe=function(e,t){(Q||0!==ee)&&ae(1,t),_.current=!1,e.cancelable&&e.preventDefault()},ce=function(e,t){(Q||ee<te-1)&&ae(-1,t),_.current=!1,e.cancelable&&e.preventDefault()},ue=function(e,t){t>ee?ce(e,t):t<ee&&oe(e,t)},ie=function(e){H.current&&"transform"===e.propertyName&&(m.addClass(H.current,"p-items-hidden"),H.current.style.transition="",0!==V&&V!==te-1||!Z||he(x))},se=function(e){var t=e.changedTouches[0];X.current={x:t.pageX,y:t.pageY}},pe=function(e){e.cancelable&&e.preventDefault()},me=function(e){var t=e.changedTouches[0];fe(e,J?t.pageY-X.current.y:t.pageX-X.current.x)},fe=function(e,t){Math.abs(t)>z&&(t<0?ce(e):oe(e))},ve=function(){F.current&&clearInterval(F.current)},de=function(){K.current||(K.current=m.createInlineStyle(t.nonce));var e,n="\n            .p-carousel[".concat(Y.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/O,"%\n            }\n        ");if(v.responsiveOptions){W.current=h(e=v.responsiveOptions)||g(e)||y(e)||b(),W.current.sort((function(e,n){return p.sort(e.breakpoint,n.breakpoint,-1,t.locale)}));for(var r=0;r<W.current.length;r++){var a=W.current[r];n+="\n                    @media screen and (max-width: ".concat(a.breakpoint,") {\n                        .p-carousel[").concat(Y.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/a.numVisible,"%\n                        }\n                    }\n                ")}}K.current.innerHTML=n},he=function(e){H.current&&(H.current.style.transform=J?"translate3d(0, ".concat(e*(100/O),"%, 0)"):"translate3d(".concat(e*(100/O),"%, 0, 0)"))};e.useImperativeHandle(d,(function(){return S({getElement:function(){return D.current}},v)})),o((function(){D.current&&(Y.current=s(),D.current.setAttribute(Y.current,"")),de(),le(),he(x),re()})),c((function(){var e=!1,t=x;if(v.autoplayInterval&&ve(),$!==I||q!==O||v.value&&B&&B.length!==v.value.length){L.current=(v.value.length-O)%I;var n=ee;0!==te&&n>=te&&(n=te-1,v.onPageChange?v.onPageChange({page:n}):M(n),e=!0),t=n*I*-1,Z&&(t-=O),n===te-1&&L.current>0?(t+=-1*L.current+I,U.current=!0):U.current=!1,t!==x&&(R(t),e=!0),he(t)}Z&&(0===V?t=-1*O:0===t&&(t=-1*v.value.length,L.current>0&&(U.current=!0)),t!==x&&(R(t),e=!0)),G!==v.page&&(v.page>G&&v.page<=te-1?ae(-1,v.page):v.page<G&&ae(1,v.page)),!e&&ne&&(F.current=setInterval((function(){ae(-1,V===te-1?0:V+1)}),v.autoplayInterval))})),u((function(){v.autoplayInterval&&ve()}));var ge=function(){if(v.value&&v.value.length){var t=null,n=null;if(Z){var r=null;t=(r=v.value.slice(-1*O)).map((function(t,n){return e.createElement(w,{key:n+"_scloned",className:"p-carousel-item-cloned",template:v.itemTemplate,item:t,active:-1*x===v.value.length+O,start:0===n,end:n===r.length-1})})),n=(r=v.value.slice(0,O)).map((function(t,n){return e.createElement(w,{key:n+"_fcloned",className:"p-carousel-item-cloned",template:v.itemTemplate,item:t,active:0===x,start:0===n,end:n===r.length-1})}))}var a=v.value.map((function(t,n){var r=Z?-1*(x+O):-1*x,a=r+O-1;return e.createElement(w,{key:n,template:v.itemTemplate,item:t,active:r<=n&&a>=n,start:r===n,end:a===n})}));return e.createElement(e.Fragment,null,t,a,n)}},ye=function(){var t=(!Q||v.value&&v.value.length<O)&&0===ee,a=i("p-carousel-prev p-link",{"p-disabled":t}),l=i("p-carousel-prev-icon pi",{"pi-chevron-left":!J,"pi-chevron-up":J});return e.createElement(r,{type:"button",className:a,icon:l,onClick:oe,disabled:t,"aria-label":n("previousPageLabel")})},be=function(){var t=(!Q||v.value&&v.value.length<O)&&(ee===te-1||0===te),a=i("p-carousel-next p-link",{"p-disabled":t}),l=i("p-carousel-next-icon pi",{"pi-chevron-right":!J,"pi-chevron-down":J});return e.createElement(r,{type:"button",className:a,icon:l,onClick:ce,disabled:t,"aria-label":n("nextPageLabel")})},Ne=function(t){var a="carousel-indicator-"+t,l=i("p-carousel-indicator",{"p-highlight":ee===t});return e.createElement("li",{key:a,className:l},e.createElement(r,{type:"button",className:"p-link",onClick:function(e){return ue(e,t)},"aria-label":"".concat(n("pageLabel")," ").concat(t+1)}))},Oe=p.findDiffKeys(v,j.defaultProps),Ce=i("p-carousel p-component",{"p-carousel-vertical":J,"p-carousel-horizontal":!J},v.className),Ee=i("p-carousel-content",v.contentClassName),Pe=function(){var t=ge(),n=J?v.verticalViewPortHeight:"auto",r=ye(),a=be(),l=i("p-carousel-container",v.containerClassName);return e.createElement("div",{className:l},r,e.createElement("div",{className:"p-carousel-items-content",style:{height:n},onTouchStart:se,onTouchMove:pe,onTouchEnd:me},e.createElement("div",{ref:H,className:"p-carousel-items-container",onTransitionEnd:ie},t)),a)}(),Se=function(){for(var t=i("p-carousel-indicators p-reset",v.indicatorsContentClassName),n=[],r=0;r<te;r++)n.push(Ne(r));return e.createElement("ul",{className:t},n)}(),we=v.header?e.createElement("div",{className:"p-carousel-header"},v.header):null,je=v.footer?e.createElement("div",{className:"p-carousel-footer"},v.footer):null;return e.createElement("div",f({ref:D,id:v.id,className:Ce,style:v.style},Oe),we,e.createElement("div",{className:Ee},Pe,Se),je)})));w.displayName="CarouselItem",j.displayName="Carousel",j.defaultProps={__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,autoplayInterval:0,numVisible:1,numScroll:1,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null};export{j as Carousel};
