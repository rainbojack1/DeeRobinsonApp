import*as e from"react";import{useMountEffect as r,useUnmountEffect as t}from"primereact/hooks";import{ObjectUtils as n}from"primereact/utils";function c(){return c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},c.apply(this,arguments)}function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var u=e.memo(e.forwardRef((function(o,a){var p=e.useRef(null),l=e.useRef(null),s=e.useRef(null),f=e.useRef(!1),d=function(){l.current=window.grecaptcha.render(p.current,{sitekey:o.siteKey,theme:o.theme,type:o.type,size:o.size,tabindex:o.tabIndex,hl:o.language,callback:h,"expired-callback":w})},m=function(){l.current&&window.grecaptcha.reset(l.current)},g=function(){return l.current?window.grecaptcha.getResponse(l.current):null},h=function(e){o.onResponse&&o.onResponse({response:e})},w=function(){o.onExpire&&o.onExpire()},y=function(){if(s.current=null,!window.grecaptcha){var e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("script");r.src="https://www.google.com/recaptcha/api.js?render=explicit",r.async=!0,r.defer=!0,r.onload=function(){window.grecaptcha?window.grecaptcha.ready((function(){d()})):console.warn("Recaptcha is not loaded")},s.current=r,e.appendChild(s.current)}};r((function(){f.current||(y(),window.grecaptcha&&d(),f.current=!0)})),t((function(){s.current&&s.current.parentNode&&s.current.parentNode.removeChild(s.current)})),e.useImperativeHandle(a,(function(){return i({reset:m,getResponse:g,getElement:function(){return p.current}},o)}));var b=n.findDiffKeys(o,u.defaultProps);return e.createElement("div",c({ref:p,id:o.id},b))})));u.displayName="Captcha",u.defaultProps={__TYPE:"Captcha",id:null,siteKey:null,theme:"light",type:"image",size:"normal",tabIndex:0,language:"en",onResponse:null,onExpire:null};export{u as Captcha};
